<?phpdefined('BASEPATH') OR exit('No direct script access allowed');class PARENT_Controller extends CI_Controller {	function __construct () {		parent::__construct();		define("SITE_BASE_URL", base_url());		define("AJAX_BASE_URL", SITE_BASE_URL."ajax/requests/");		define("IMAGES_BASE_URL", SITE_BASE_URL."assets/images/");	}		public function ajax_request_state () {				if ( $this->input->is_ajax_request () ) {			return true;		}		return false;	}			function drawajax( $data ) {				if ( ! empty ( $data["ajaxpage"] ) ) {			return $this->load->view ( "ajax/ajax--" . $data["ajaxpage"], $data, true );		}		return false;			}	}class MY_Controller extends PARENT_Controller {		function __construct() {		parent::__construct ();	}	function drawpage ( $data = "" ) {				$view 					= "default";		$sub 					= "";		$con					= true;				if ( empty ( $data["sub"] ) ) {			$data = array_merge( array( "sub" => "" ), $data );			if ( file_exists ( APPPATH . "views/pages/page--". $data["view"] . ".php" ) ) {				$view 	= $data["view"];			}		} else {			if ( file_exists ( APPPATH . "views/pages/page--". $data["view"] . "-" . $data["sub"] . ".php" ) ) {				$view 	= $data["view"] . "-" . $data["sub"];				$sub	= $data["sub"];			}		}						if ($con) {						if ( parent::ajax_request_state () ) {								if ( empty ($data["nosleep"]) ) {					//sleep(1);				}				$data		= array_merge ( $data, array ( "ajax_state" => "re_" ) );						print json_encode ( 							array ( 								"contents" 		=> $this->load->view ( "templates/tpl.navigation.php", $data, true ) . 													$this->load->view ( "pages/page--" . $view, $data, true ) . 													$this->load->view ( "templates/tpl--getscript.php", $data, true ) .													"<script>var _sub = \"{$sub}\"</script>", 								"page_title" 	=> (empty($sub))?strtoupper(str_replace("-"," ",$view)):strtoupper(str_replace("-"," ",$sub)) 							) 						);							} else {				$data	= array_merge ( $data, array ( "ajax_state" => "" ) );				$this->load->view ( "templates/tpl--header.php", $data );				$this->load->view ( "templates/tpl--navigation.php", $data );				$this->load->view ( "pages/page--" . $view, $data );				$this->load->view ( "templates/tpl--footer.php", $data );							}					} else {						if ( parent::ajax_request_state () ) {				print json_encode ( 							array ( 								"contents" 		=> $this->load->view ( "pages/page--not-allowed", $data, true ),								"page_title" 	=> "Not Allowed"							) 						);							} else {				$this->load->view ( "pages/page--not-allowed", $data );							}								}							}	}class MY_Ajax extends PARENT_Controller {		function __construct() {		parent::__construct ();		/* self::ajaxchecknotlogin(); */	}			private function ajaxchecknotlogin () {		if ( ! $this->session->userdata( "sess_logged" ) and strpos ($_SERVER["HTTP_REFERER"],"login") === false ) {			print json_encode ( array ("is_logout" => true ) );			exit;		} else {					}	}	}